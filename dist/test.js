const path=require("path"),{bold:bold}=require("@nexssp/ansi"),{error:error}=require("@nexssp/logdebug"),{testOne:testOne}=require("./testOne"),testAll=async(e="./src/",{glob:r,display:s=!1,ignore:t=[],dry:o,stopOnError:n}={})=>{require("fs").existsSync(e)||(error(`Source folder does not exist. ${e}`),process.exit(1)),t.includes("!**/node_modules")||(t=t.concat("!**/node_modules")),r=r||"./*_nexss-test.js",e.endsWith("/")||e.endsWith("\\")||(error("Source folder must contain at the end '/' eg: ./src/"),process.exit(1));const l=require("fast-glob");let i=`${e}${r}`.replace(/\\/g,"/");const d=await l([i],{ignore:t});if(o)return void console.log(d);0===d.length&&(error(bold(`No test files has been found in the ${path.resolve(e)}`)),error(bold("Please remove testing command or add/check testing files.")),process.exit(1));const c=process.cwd();return await Promise.all(d.map((async e=>testOne(`${c}/${e}`,{display:s,stopOnError:n}))))};module.exports={testAll:testAll};